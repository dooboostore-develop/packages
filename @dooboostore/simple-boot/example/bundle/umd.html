<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>@dooboostore/simple-boot UMD Bundle Example</title>
  <style>
    body { font-family: sans-serif; padding: 1em; }
    h1 { color: #333; }
    .container { border: #ccc 1px solid; padding: 20px; margin: 10px 0; border-radius: 5px; }
    button { margin-right: 10px; padding: 5px 10px; }
    .output { background: #f5f5f5; padding: 10px; margin: 10px 0; border-radius: 3px; }
  </style>
</head>
<body>
  <h1>@dooboostore/simple-boot UMD Bundle Example</h1>
  <p>Check the browser's developer console for output. The same output is also displayed below:</p>
  <pre id="output"><code></code></pre>

  <script src="./dooboostore-simple-boot.umd.js"></script>
  <script>
    // Redirect console.log to display on the page for better visibility
    const outputEl = document.getElementById('output');
    const originalLog = console.log;
    console.log = (...args) => {
        originalLog.apply(console, args);
        outputEl.textContent += args.map(a => typeof a === 'object' ? JSON.stringify(a, null, 2) : a).join(' ') + '\n';
    };

    const { SimpleApplication, Sim, Router } = window.dooboostoreSimpleBoot;

    console.log('--- Simple Boot Bundle Example (UMD) ---');

    // --- Define Services ---
    class UserService {
      getUsers() {
        return ['Alice', 'Bob', 'Charlie'];
      }
    }
    Sim(UserService);

    class ApiService {
      constructor() {
        // Manual injection - get UserService from app
        this.userService = null;
      }

      setUserService(userService) {
        this.userService = userService;
      }

      getData() {
        return this.userService ? this.userService.getUsers() : ['No service available'];
      }
    }
    Sim(ApiService);

    // --- Define Router ---
    class AppRouter {}
    Router({ 
      path: '', 
      route: { 
        '/': UserService,
        '/users': UserService 
      } 
    })(AppRouter);
    Sim(AppRouter);

    console.log('Initializing SimpleApplication...');
    const app = new SimpleApplication({ rootRouter: AppRouter });
    app.run();
    console.log('SimpleApplication is running.');

    console.log('\nCalling services from app:');
    
    // Get service instances
    const userService = app.sim(UserService);
    const apiService = app.sim(ApiService);
    
    if (userService) {
      const users = userService.getUsers();
      console.log('Users from UserService:', users);
    } else {
      console.log('Could not get UserService instance.');
    }

    if (apiService) {
      // Manual injection
      apiService.setUserService(userService);
      const data = apiService.getData();
      console.log('Data from ApiService:', data);
    } else {
      console.log('Could not get ApiService instance.');
    }

    console.log('\nSimple Boot bundle example completed!');
  </script>
</body>
</html>
